<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Student Attendance System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.3/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgb(255, 255, 255);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(241, 239, 239, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #8e1919, #8e1919);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #ddd;
        }

        
        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .nav-tab.active {
            background: white;
            color: #8e1919;
            border-bottom-color: #851d1d;
        }

        .nav-tab:hover {
            background: #e9ecef;
            color: #333;
        }

        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.3s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

                .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #7f2222;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #af4c4c, #a04545);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgb(159, 31, 31);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .student-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .student-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #af4c4c;
        }

        .student-info h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .student-info p {
            color: #666;
            margin-bottom: 5px;
        }

        .qr-code {
            text-align: center;
            margin: 15px 0;
        }

        .scanner-container {
            max-width: 500px;
            margin: 0 auto;
            text-align: center;
        }

        #qr-reader {
            border: 3px dashed #af4c4c;
            border-radius: 12px;
            overflow: hidden;
        }

        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .attendance-table th,
        .attendance-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .attendance-table th {
            background: #af4c4c;
            color: white;
            font-weight: 600;
        }

        .attendance-table tr:hover {
            background: #f8f9fa;
        }

        .status-present {
            color: #a72828;
            font-weight: bold;
        }

        .status-absent {
            color: #dc3545;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
                        padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .success-message, .error-message {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .date-filter {
            display: flex;
            gap: 15px;
            align-items: end;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .date-filter {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>QUIRINO GENERAL HIGH SCHOOL</h1>
            <h2>QR Attendance System</h2>
            <p>Streamlined student attendance tracking with QR code technology</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('students')">ðŸ‘¥ Students</button>
            <button class="nav-tab" onclick="showTab('scanner')">ðŸ“· Scanner</button>
            <button class="nav-tab" onclick="showTab('attendance')">ðŸ“Š Attendance</button>
            <button class="nav-tab" onclick="showTab('reports')">ðŸ“ˆ Reports</button>
            <button class="nav-tab" onclick="showTab('export')">ðŸ’¾ Export</button>
        </div>

        <!-- Students Tab -->
        <div id="students" class="tab-content active">
            <h2>Student Management</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="studentName">Student Name</label>
                    <input type="text" id="studentName" placeholder="Enter student name">
                </div>
                <div class="form-group">
                    <label for="studentId">Student ID</label>
                    <input type="text" id="studentId" placeholder="Enter student ID">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="studentEmail">Email</label>
                    <input type="email" id="studentEmail" placeholder="student@email.com">
                </div>
                <div class="form-group">
                    <label for="studentClass">Class/Section</label>
                    <input type="text" id="studentClass" placeholder="Enter class or section">
                </div>
            </div>

            <button class="btn" onclick="addStudent()">Add Student</button>

            <div id="studentsList" class="student-list"></div>
        </div>

        <!-- Scanner Tab -->
        <div id="scanner" class="tab-content">
            <h2>QR Code Scanner</h2>
            
            <div class="scanner-container">
                <div class="form-group">
                    <label for="sessionName">Session/Class Name</label>
                    <input type="text" id="sessionName" placeholder="e.g., Math Class - Monday">
                </div>
                
                <button class="btn" onclick="startScanner()" id="startScanBtn">Start Scanner</button>
                <button class="btn btn-danger" onclick="stopScanner()" id="stopScanBtn" style="display: none;">Stop Scanner</button>
                
                <div id="qr-reader" style="display: none; margin: 20px 0;"></div>
                <div id="scanResult"></div>
            </div>
        </div>

        <!-- Attendance Tab -->
        <div id="attendance" class="tab-content">
            <h2>Attendance Records</h2>
            
            <div class="date-filter">
                <div class="form-group">
                    <label for="filterDate">Filter by Date</label>
                    <input type="date" id="filterDate">
                </div>
                <div class="form-group">
                    <label for="filterSession">Filter by Session</label>
                    <select id="filterSession">
                        <option value="">All Sessions</option>
                    </select>
                </div>
                <button class="btn btn-secondary" onclick="filterAttendance()">Apply Filter</button>
                <button class="btn btn-secondary" onclick="clearFilters()">Clear Filters</button>
            </div>

            <div id="attendanceTable"></div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <h2>Attendance Reports</h2>
            
            <div class="stats-grid" id="statsGrid"></div>
                        
            <h3>Individual Student Reports</h3>
            <div id="individualReports"></div>
        </div>

        <!-- Export Tab -->
        <div id="export" class="tab-content">
            <h2>Export Data</h2>
            
            <p>Export your attendance data to Excel format for further analysis or record keeping.</p>
            
            <div class="form-row">
                <button class="btn" onclick="exportToExcel()">ðŸ“Š Export Attendance to Excel</button>
                <button class="btn btn-secondary" onclick="exportStudents()">ðŸ‘¥ Export Student List</button>
            </div>

            <div class="form-group">
                <label for="importFile">Import Student Data (Excel/CSV)</label>
                <input type="file" id="importFile" accept=".xlsx,.xls,.csv" onchange="importStudentData(event)">
            </div>
        </div>
    </div>

    <div><img src="ffe218c6-afd0-4996-b1c3-2726f4d61824-removebg-preview.png" alt="DepEd" style="position:absolute; top:45px; left:250px; width:120px;"></div>

    <script>
        // Global variables
        let students = [];
        let attendanceRecords = [];     
        let html5QrcodeScanner = null;
        let currentSession = '';

        // Initialize the application
        function init() {
            loadData();
            updateStudentsList();
            updateAttendanceTable();
            updateReports();
            updateSessionFilter();
        }

        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Student management
        function addStudent() {
            const name = document.getElementById('studentName').value.trim();
            const id = document.getElementById('studentId').value.trim();
            const email = document.getElementById('studentEmail').value.trim();
            const studentClass = document.getElementById('studentClass').value.trim();

            if (!name || !id) {
                showMessage('Please enter both student name and ID', 'error');
                return;
            }

            if (students.find(s => s.id === id)) {
                showMessage('Student ID already exists', 'error');
                return;
            }

            const student = {
                name,
                id,
                email,
                class: studentClass,
                qrCode: generateQRData(id)
            };

            students.push(student);
            saveData();
            updateStudentsList();
            
            // Clear form
            document.getElementById('studentName').value = '';
            document.getElementById('studentId').value = '';
            document.getElementById('studentEmail').value = '';
            document.getElementById('studentClass').value = '';

            showMessage('Student added successfully!', 'success');
        }

        function removeStudent(studentId) {
            if (confirm('Are you sure you want to remove this student?')) {
                students = students.filter(s => s.id !== studentId);
                attendanceRecords = attendanceRecords.filter(r => r.studentId !== studentId);
                saveData();
                updateStudentsList();
                updateAttendanceTable();
                updateReports();
                                showMessage('Student removed successfully!', 'success');
            }
        }

        function generateQRData(studentId) {
            return JSON.stringify({
                studentId: studentId,
                timestamp: Date.now()
            });
        }

        function updateStudentsList() {
            const container = document.getElementById('studentsList');
            container.innerHTML = '';

            students.forEach(student => {
                const card = document.createElement('div');
                card.className = 'student-card';
                
                const qrCodeDiv = document.createElement('div');
                qrCodeDiv.className = 'qr-code';
                
                // Generate QR code
                QRCode.toCanvas(qrCodeDiv, student.qrCode, {
                    width: 150,
                    height: 150,
                    margin: 2
                }, (error) => {
                    if (error) console.error(error);
                });

                card.innerHTML = `
                    <div class="student-info">
                        <h3>${student.name}</h3>
                        <p><strong>ID:</strong> ${student.id}</p>
                        <p><strong>Email:</strong> ${student.email || 'N/A'}</p>
                        <p><strong>Class:</strong> ${student.class || 'N/A'}</p>
                    </div>
                    <div class="qr-code-container"></div>
                    <button class="btn btn-danger" onclick="removeStudent('${student.id}')">Remove</button>
                `;
                
                card.querySelector('.qr-code-container').appendChild(qrCodeDiv);
                container.appendChild(card);
            });
        }

        // QR Scanner functionality
        function startScanner() {
            const sessionName = document.getElementById('sessionName').value.trim();
            if (!sessionName) {
                showMessage('Please enter a session name', 'error');
                return;
            }

            currentSession = sessionName;
            
            const qrReaderDiv = document.getElementById('qr-reader');
            qrReaderDiv.style.display = 'block';

            html5QrcodeScanner = new Html5QrcodeScanner("qr-reader", {
                fps: 10,
                qrbox: { width: 250, height: 250 },
                aspectRatio: 1.0
            });

            html5QrcodeScanner.render(onScanSuccess, onScanFailure);
            
            document.getElementById('startScanBtn').style.display = 'none';
            document.getElementById('stopScanBtn').style.display = 'inline-block';
        }

        function stopScanner() {
            if (html5QrcodeScanner) {
                html5QrcodeScanner.clear();
                html5QrcodeScanner = null;
            }
            
            document.getElementById('qr-reader').style.display = 'none';
            document.getElementById('startScanBtn').style.display = 'inline-block';
            document.getElementById('stopScanBtn').style.display = 'none';
            document.getElementById('scanResult').innerHTML = '';
        }

        function onScanSuccess(decodedText, decodedResult) {
            try {
                const qrData = JSON.parse(decodedText);
                const studentId = qrData.studentId;
                const student = students.find(s => s.id === studentId);

                if (!student) {
                    showScanResult('Student not found in database', 'error');
                    return;
                }

                // Check if already marked present today
                const today = new Date().toDateString();
                const existingRecord = attendanceRecords.find(r => 
                    r.studentId === studentId && 
                    r.session === currentSession &&
                                        new Date(r.date).toDateString() === today
                );

                if (existingRecord) {
                    showScanResult(`${student.name} already marked present for this session today`, 'error');
                    return;
                }

                // Mark attendance
                const attendanceRecord = {
                    studentId: studentId,
                    studentName: student.name,
                    session: currentSession,
                    date: new Date().toISOString(),
                    status: 'Present'
                };

                attendanceRecords.push(attendanceRecord);
                saveData();
                updateAttendanceTable();
                updateReports();
                updateSessionFilter();

                showScanResult(`âœ… ${student.name} marked present!`, 'success');

            } catch (error) {
                showScanResult('Invalid QR code format', 'error');
            }
        }

        function onScanFailure(error) {
            // Handle scan failure silently
        }

        function showScanResult(message, type) {
            const resultDiv = document.getElementById('scanResult');
            resultDiv.className = type === 'success' ? 'success-message' : 'error-message';
            resultDiv.innerHTML = message;

            setTimeout(() => {
                resultDiv.innerHTML = '';
            }, 3000);
        }

        // Attendance management
        function updateAttendanceTable() {
            const container = document.getElementById('attendanceTable');
            
            if (attendanceRecords.length === 0) {
                container.innerHTML = '<p>No attendance records found.</p>';
                return;
            }

            let filteredRecords = [...attendanceRecords];
            
            // Apply date filter if set
            const filterDate = document.getElementById('filterDate')?.value;
            if (filterDate) {
                filteredRecords = filteredRecords.filter(record => 
                    new Date(record.date).toDateString() === new Date(filterDate).toDateString()
                );
            }

            // Apply session filter if set
            const filterSession = document.getElementById('filterSession')?.value;
            if (filterSession) {
                filteredRecords = filteredRecords.filter(record => record.session === filterSession);
            }

            // Sort by date (newest first)
            filteredRecords.sort((a, b) => new Date(b.date) - new Date(a.date));

            const table = document.createElement('table');
            table.className = 'attendance-table';
            
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Student Name</th>
                        <th>Student ID</th>
                        <th>Session</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    ${filteredRecords.map(record => `
                        <tr>
                            <td>${record.studentName}</td>
                            <td>${record.studentId}</td>
                            <td>${record.session}</td>
                            <td>${new Date(record.date).toLocaleDateString()}</td>
                            <td>${new Date(record.date).toLocaleTimeString()}</td>
                            <td class="status-${record.status.toLowerCase()}">${record.status}</td>
                        </tr>
                    `).join('')}
                </tbody>
            `;

            container.innerHTML = '';
            container.appendChild(table);
        }

        function updateSessionFilter() {
            const select = document.getElementById('filterSession');
            const sessions = [...new Set(attendanceRecords.map(r => r.session))];
            
            select.innerHTML = '<option value="">All Sessions</option>';
            sessions.forEach(session => {
                const option = document.createElement('option');
                option.value = session;
                option.textContent = session;
                select.appendChild(option);
            });
        }

        function filterAttendance() {
            updateAttendanceTable();
        }

        function clearFilters() {
            document.getElementById('filterDate').value = '';
            document.getElementById('filterSession').value = '';
            updateAttendanceTable();
        }

        // Reports
        function updateReports() {
            updateStats();
            updateIndividualReports();
        }

        function updateStats() {
            const container = document.getElementById('statsGrid');
            const totalStudents = students.length;
            const totalSessions = new Set(attendanceRecords.map(r => r.session)).size;
            const todayAttendance = attendanceRecords.filter(r => 
                new Date(r.date).toDateString() === new Date().toDateString()
            ).length;

            const avgAttendance = totalSessions > 0 ? 
                Math.round((attendanceRecords.length / (totalStudents * totalSessions)) * 100) : 0;

            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${totalStudents}</div>
                    <div class="stat-label">Total Students</div>
                </div>
                <div class="stat-card">
                                <div class="stat-number">${totalSessions}</div>
                    <div class="stat-label">Total Sessions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${todayAttendance}</div>
                    <div class="stat-label">Today's Attendance</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${avgAttendance}%</div>
                    <div class="stat-label">Average Attendance</div>
                </div>
            `;
        }

        function updateIndividualReports() {
            const container = document.getElementById('individualReports');
            
            if (students.length === 0) {
                container.innerHTML = '<p>No students registered yet.</p>';
                return;
            }

            const table = document.createElement('table');
            table.className = 'attendance-table';
            
            const studentStats = students.map(student => {
                const studentRecords = attendanceRecords.filter(r => r.studentId === student.id);
                const totalSessions = new Set(attendanceRecords.map(r => r.session)).size;
                const attendanceRate = totalSessions > 0 ? 
                    Math.round((studentRecords.length / totalSessions) * 100) : 0;

                return {
                    ...student,
                    totalAttendance: studentRecords.length,
                    attendanceRate: attendanceRate
                };
            });

            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Student Name</th>
                        <th>Student ID</th>
                        <th>Total Attendance</th>
                        <th>Attendance Rate</th>
                    </tr>
                </thead>
                <tbody>
                    ${studentStats.map(student => `
                        <tr>
                            <td>${student.name}</td>
                            <td>${student.id}</td>
                            <td>${student.totalAttendance}</td>
                            <td>${student.attendanceRate}%</td>
                        </tr>
                    `).join('')}
                </tbody>
            `;

            container.innerHTML = '';
            container.appendChild(table);
        }

        // Data persistence
        function saveData() {
            const data = {
                students: students,
                attendanceRecords: attendanceRecords
            };
            // In a real Excel file, this would save to the spreadsheet
            // For this demo, we'll store in memory
            window.attendanceData = data;
        }

        function loadData() {
            // In a real Excel file, this would load from the spreadsheet
            // For this demo, we'll use sample data
            if (!window.attendanceData) {
                window.attendanceData = {
                    students: [],
                    attendanceRecords: []
                };
            }
            
            students = window.attendanceData.students || [];
            attendanceRecords = window.attendanceData.attendanceRecords || [];
        }

        // Export functionality
        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            
            // Attendance sheet
            const attendanceData = attendanceRecords.map(record => ({
                'Student Name': record.studentName,
                'Student ID': record.studentId,
                'Session': record.session,
                'Date': new Date(record.date).toLocaleDateString(),
                'Time': new Date(record.date).toLocaleTimeString(),
                'Status': record.status
                            }));
            
            const attendanceWS = XLSX.utils.json_to_sheet(attendanceData);
            XLSX.utils.book_append_sheet(wb, attendanceWS, 'Attendance Records');
            
            // Students sheet
            const studentsData = students.map(student => ({
                'Student Name': student.name,
                'Student ID': student.id,
                'Email': student.email || '',
                'Class': student.class || ''
            }));
            
            const studentsWS = XLSX.utils.json_to_sheet(studentsData);
            XLSX.utils.book_append_sheet(wb, studentsWS, 'Students');
            
            // Save file
            XLSX.writeFile(wb, `Attendance_Report_${new Date().toISOString().split('T')[0]}.xlsx`);
            showMessage('Excel file exported successfully!', 'success');
        }

        function exportStudents() {
            const wb = XLSX.utils.book_new();
            
            const studentsData = students.map(student => ({
                'Student Name': student.name,
                'Student ID': student.id,
                'Email': student.email || '',
                'Class': student.class || ''
            }));
            
            const ws = XLSX.utils.json_to_sheet(studentsData);
            XLSX.utils.book_append_sheet(wb, ws, 'Students');
            
            XLSX.writeFile(wb, `Students_List_${new Date().toISOString().split('T')[0]}.xlsx`);
            showMessage('Student list exported successfully!', 'success');
        }

        function importStudentData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet);

                    let importedCount = 0;
                    jsonData.forEach(row => {
                        const name = row['Student Name'] || row['Name'];
                        const id = row['Student ID'] || row['ID'];
                        const email = row['Email'] || '';
                        const studentClass = row['Class'] || row['Section'] || '';

                        if (name && id && !students.find(s => s.id === id)) {
                            const student = {
                                name,
                                id,
                                email,
                                class: studentClass,
                                qrCode: generateQRData(id)
                            };
                            students.push(student);
                            importedCount++;
                        }
                    });

                    saveData();
                    updateStudentsList();
                    showMessage(`Successfully imported ${importedCount} students!`, 'success');
                    
                } catch (error) {
                    showMessage('Error importing file. Please check the format.', 'error');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // Utility functions
        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.innerHTML = message;
            
            // Insert at the top of the active tab
            const activeTab = document.querySelector('.tab-content.active');
            activeTab.insertBefore(messageDiv, activeTab.firstChild);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 5000);
        }

        // Initialize the app when the page loads
        window.onload = init;
    </script>
</body>
</html>