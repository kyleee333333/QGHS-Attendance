<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Offline Quiz with Explanations</title>
<style>
  body{background:#0b1220;color:#e6eef6;font-family:Arial,Helvetica,sans-serif;margin:0;padding:0}
  .wrap{max-width:900px;margin:20px auto;background:#111c33;padding:20px;border-radius:10px}
  h1{margin:0 0 10px 0}
  button{background:#06b6d4;color:#041d26;border:none;padding:8px 14px;margin:4px;border-radius:6px;cursor:pointer;font-weight:bold}
  button.secondary{background:transparent;border:1px solid #06b6d4;color:#06b6d4}
  textarea,input,select{width:100%;margin:4px 0 10px;padding:8px;border-radius:6px;border:none;background:#16233e;color:white}
  .panel{background:#0f1a2f;padding:15px;border-radius:8px;margin-top:15px}
  .choice{background:#1c2a4d;padding:10px;border-radius:6px;margin-top:5px;cursor:pointer}
  .choice.correct{background:#146b35}
  .choice.wrong{background:#8a2525}
  .explanation{background:#182c4b;padding:10px;margin-top:8px;border-left:4px solid #06b6d4;border-radius:4px;font-size:0.9em}
  .hidden{display:none}
</style>
</head>
<body>
<div class="wrap">
  <h1>Offline Quiz (with Explanations)</h1>

  <div id="managePanel">
    <h3>Add / Edit Question</h3>
    <textarea id="qText" placeholder="Enter your question"></textarea>
    <input id="c0" placeholder="Choice A">
    <input id="c1" placeholder="Choice B">
    <input id="c2" placeholder="Choice C">
    <input id="c3" placeholder="Choice D">
    <label>Correct Answer:</label>
    <select id="correct">
      <option value="0">A</option>
      <option value="1">B</option>
      <option value="2">C</option>
      <option value="3">D</option>
    </select>
    <textarea id="explanation" rows="2" placeholder="Explanation (Why this answer is correct)"></textarea>
    <button id="addBtn">Add Question</button>
    <button id="clearBtn" class="secondary">Clear</button>
    <button id="startQuizBtn" class="secondary">Start Quiz</button>

    <h3>Question Bank</h3>
    <div id="list"></div>
  </div>

  <div id="quizPanel" class="hidden">
    <div id="qArea"></div>
    <button id="nextBtn" class="hidden">Next</button>
  </div>
</div>

<script>
let questions = JSON.parse(localStorage.getItem("quizBank")||"[]");
const qText=document.getElementById("qText"), c0=document.getElementById("c0"), c1=document.getElementById("c1"),
c2=document.getElementById("c2"), c3=document.getElementById("c3"), correct=document.getElementById("correct"),
explanation=document.getElementById("explanation"), list=document.getElementById("list"),
addBtn=document.getElementById("addBtn"), clearBtn=document.getElementById("clearBtn"),
startQuizBtn=document.getElementById("startQuizBtn"), managePanel=document.getElementById("managePanel"),
quizPanel=document.getElementById("quizPanel"), qArea=document.getElementById("qArea"), nextBtn=document.getElementById("nextBtn");

function renderList(){
  list.innerHTML="";
  questions.forEach((q,i)=>{
    const div=document.createElement("div");
    div.innerHTML=`${i+1}. ${q.text} <br><small><i>${q.choices.map((c,j)=>String.fromCharCode(65+j)+": "+c).join(", ")}</i></small>`;
    div.style.marginBottom="8px";
    list.appendChild(div);
  });
  localStorage.setItem("quizBank",JSON.stringify(questions));
}
renderList();

addBtn.onclick=()=>{
  if(!qText.value.trim()){alert("Enter a question");return;}
  const q={
    text:qText.value.trim(),
    choices:[c0.value,c1.value,c2.value,c3.value],
    answer:Number(correct.value),
    explanation:explanation.value.trim()||"No explanation provided."
  };
  questions.push(q);
  localStorage.setItem("quizBank",JSON.stringify(questions));
  renderList(); clearForm();
};
clearBtn.onclick=clearForm;
function clearForm(){qText.value="";c0.value=c1.value=c2.value=c3.value="";explanation.value="";}

let index=0, score=0;
startQuizBtn.onclick=()=>{
  if(questions.length==0){alert("Add questions first!");return;}
  managePanel.classList.add("hidden");
  quizPanel.classList.remove("hidden");
  index=0; score=0; renderQuestion();
};

function renderQuestion(){
  qArea.innerHTML="";
  nextBtn.classList.add("hidden");
  const q=questions[index];
  const h=document.createElement("div");
  h.className="panel";
  h.innerHTML=`<h3>${index+1}. ${q.text}</h3>`;
  qArea.appendChild(h);
  q.choices.forEach((ch,i)=>{
    const d=document.createElement("div");
    d.className="choice";
    d.innerText=String.fromCharCode(65+i)+". "+ch;
    d.onclick=()=>selectAnswer(i,q.answer,q.explanation,d);
    qArea.appendChild(d);
  });
}

function selectAnswer(i,correctIndex,explanationText,choiceDiv){
  const choices=qArea.querySelectorAll(".choice");
  choices.forEach((c,idx)=>{
    c.onclick=null;
    if(idx===correctIndex) c.classList.add("correct");
    if(idx===i && i!==correctIndex) c.classList.add("wrong");
  });
  if(i===correctIndex) score++;
  const exp=document.createElement("div");
  exp.className="explanation";
  exp.innerHTML=`<strong>Explanation:</strong> ${explanationText}`;
  qArea.appendChild(exp);
  nextBtn.classList.remove("hidden");
}
nextBtn.onclick=()=>{
  index++;
  if(index<questions.length) renderQuestion();
  else endQuiz();
};
function endQuiz(){
  qArea.innerHTML=`<h2>Quiz Complete!</h2>
  <p>Your score: ${score}/${questions.length}</p>
  <button onclick="restart()">Restart</button>
  <button onclick="exit()">Exit</button>`;
  nextBtn.classList.add("hidden");
}
function restart(){index=0;score=0;renderQuestion();}
function exit(){
  quizPanel.classList.add("hidden");
  managePanel.classList.remove("hidden");
  renderList();
}
</script>
</body>
</html>
